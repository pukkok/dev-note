"use strict";(self.webpackChunkdev_note=self.webpackChunkdev_note||[]).push([[7615],{1074:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>t,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>d,toc:()=>c});const d=JSON.parse('{"id":"kinder-moumi/backend/upload-customizing","title":"2. \ud30c\uc77c \uc5c5\ub85c\ub4dc","description":"kinder-moumi\uc5d0\uc11c\ub294 \uad50\uc0ac\uac00 \uc9c1\uc811 \uc720\uce58\uc6d0 \ud648\ud398\uc774\uc9c0\ub97c \uc81c\uc791\ud558\uace0 \uad6c\uc131\ud560 \uc218 \uc788\ub3c4\ub85d \ub2e4\uc591\ud55c \ucee4\uc2a4\ud130\ub9c8\uc774\uc9d5 \uae30\ub2a5\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4.","source":"@site/project/kinder-moumi/backend/upload-customizing.md","sourceDirName":"kinder-moumi/backend","slug":"/kinder-moumi/backend/upload-customizing","permalink":"/dev-note/project/kinder-moumi/backend/upload-customizing","draft":false,"unlisted":false,"editUrl":"https://github.com/pukkok/dev-note/edit/main/project/kinder-moumi/backend/upload-customizing.md","tags":[],"version":"current","frontMatter":{"title":"2. \ud30c\uc77c \uc5c5\ub85c\ub4dc"},"sidebar":"sidebar","previous":{"title":"1. \uc778\uc99d\uacfc \uad8c\ud55c","permalink":"/dev-note/project/kinder-moumi/backend/auth"},"next":{"title":"3. API","permalink":"/dev-note/project/kinder-moumi/backend/kinder-API"}}');var r=l(4848),i=l(8453);const s={title:"2. \ud30c\uc77c \uc5c5\ub85c\ub4dc"},o="\ud30c\uc77c \uc5c5\ub85c\ub4dc \ubc0f \ud648\ud398\uc774\uc9c0 \ucee4\uc2a4\ud130\ub9c8\uc774\uc9d5",t={},c=[{value:"\u2705 \uc8fc\uc694 \uae30\uc220 \uc2a4\ud0dd",id:"-\uc8fc\uc694-\uae30\uc220-\uc2a4\ud0dd",level:2},{value:"1. \ub85c\uace0 \ubc0f \ubc30\uacbd \uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc",id:"1-\ub85c\uace0-\ubc0f-\ubc30\uacbd-\uc774\ubbf8\uc9c0-\uc5c5\ub85c\ub4dc",level:2},{value:"\ub85c\uace0 \uc5c5\ub85c\ub4dc (<code>/platform/upload/logo</code>)",id:"\ub85c\uace0-\uc5c5\ub85c\ub4dc-platformuploadlogo",level:3},{value:"\ubc30\uacbd \uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc (<code>/platform/upload/bg-list</code>)",id:"\ubc30\uacbd-\uc774\ubbf8\uc9c0-\uc5c5\ub85c\ub4dc-platformuploadbg-list",level:3},{value:"\ubc30\uacbd \uc774\ubbf8\uc9c0 \uc0ad\uc81c (<code>/platform/bg-data</code>, PUT)",id:"\ubc30\uacbd-\uc774\ubbf8\uc9c0-\uc0ad\uc81c-platformbg-data-put",level:3},{value:"2. \ud648\ud398\uc774\uc9c0 \ub370\uc774\ud130 \uc800\uc7a5 (<code>/platform/upload/data</code>)",id:"2-\ud648\ud398\uc774\uc9c0-\ub370\uc774\ud130-\uc800\uc7a5-platformuploaddata",level:2},{value:"3. \ud398\uc774\uc9c0 \uac8c\uc2dc \uc694\uccad (<code>/platform/startpage</code>)",id:"3-\ud398\uc774\uc9c0-\uac8c\uc2dc-\uc694\uccad-platformstartpage",level:2},{value:"4. \uba54\ub274 \ubc0f \uc2dd\ub2e8\ud45c \uc124\uc815",id:"4-\uba54\ub274-\ubc0f-\uc2dd\ub2e8\ud45c-\uc124\uc815",level:2},{value:"\uba54\ub274 \uc635\uc158 \ubc0f \uc81c\uc678 \uc694\uc77c \uc800\uc7a5",id:"\uba54\ub274-\uc635\uc158-\ubc0f-\uc81c\uc678-\uc694\uc77c-\uc800\uc7a5",level:3},{value:"\uc6d4\ubcc4 \uc2dd\ub2e8\ud45c \uc800\uc7a5 (<code>/platform/menu/table</code>)",id:"\uc6d4\ubcc4-\uc2dd\ub2e8\ud45c-\uc800\uc7a5-platformmenutable",level:3},{value:"\uc815\ub9ac",id:"\uc815\ub9ac",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"\ud30c\uc77c-\uc5c5\ub85c\ub4dc-\ubc0f-\ud648\ud398\uc774\uc9c0-\ucee4\uc2a4\ud130\ub9c8\uc774\uc9d5",children:"\ud30c\uc77c \uc5c5\ub85c\ub4dc \ubc0f \ud648\ud398\uc774\uc9c0 \ucee4\uc2a4\ud130\ub9c8\uc774\uc9d5"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"kinder-moumi"}),"\uc5d0\uc11c\ub294 \uad50\uc0ac\uac00 \uc9c1\uc811 ",(0,r.jsx)(n.strong,{children:"\uc720\uce58\uc6d0 \ud648\ud398\uc774\uc9c0\ub97c \uc81c\uc791\ud558\uace0 \uad6c\uc131"}),"\ud560 \uc218 \uc788\ub3c4\ub85d \ub2e4\uc591\ud55c \ucee4\uc2a4\ud130\ub9c8\uc774\uc9d5 \uae30\ub2a5\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4. ",(0,r.jsx)("br",{}),"\n\uc0ac\uc6a9\uc790\ub294 \ub85c\uace0, \ubc30\uacbd \uc774\ubbf8\uc9c0, \uba54\ub274 \uc2a4\ud0c0\uc77c \ub4f1\uc744 S3\uc5d0 \uc5c5\ub85c\ub4dc\ud558\uace0 DB\uc5d0 \uc800\uc7a5\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-\uc8fc\uc694-\uae30\uc220-\uc2a4\ud0dd",children:"\u2705 \uc8fc\uc694 \uae30\uc220 \uc2a4\ud0dd"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Multer + multer-s3"}),": \uc774\ubbf8\uc9c0 \ud30c\uc77c \uc5c5\ub85c\ub4dc \ucc98\ub9ac"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"AWS S3"}),": \uc815\uc801 \uc790\uc0b0 \uc800\uc7a5\uc18c"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"MongoDB"}),": \uc720\uce58\uc6d0\ubcc4 \ucee4\uc2a4\ud130\ub9c8\uc774\uc9d5 \ub370\uc774\ud130 \uc800\uc7a5"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"1-\ub85c\uace0-\ubc0f-\ubc30\uacbd-\uc774\ubbf8\uc9c0-\uc5c5\ub85c\ub4dc",children:"1. \ub85c\uace0 \ubc0f \ubc30\uacbd \uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc"}),"\n",(0,r.jsxs)(n.h3,{id:"\ub85c\uace0-\uc5c5\ub85c\ub4dc-platformuploadlogo",children:["\ub85c\uace0 \uc5c5\ub85c\ub4dc (",(0,r.jsx)(n.code,{children:"/platform/upload/logo"}),")"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const uploadLogo = multer({\n  storage: multerS3({\n    s3,\n    bucket: 'kindermoumi',\n    acl: 'public-read',\n    contentType: multerS3.AUTO_CONTENT_TYPE,\n    key(req, file, cb) {\n      cb(null, `logo/${Date.now()}_${path.basename(file.originalname)}`)\n    }\n  }),\n  fileFilter: imgFilter\n})\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc774\ubbf8\uc9c0\uac00 \uc544\ub2cc \ud30c\uc77c\uc740 \uac70\ubd80\ub428 (",(0,r.jsx)(n.code,{children:"file.mimetype"})," \uac80\uc0ac)"]}),"\n",(0,r.jsxs)(n.li,{children:["\uc5c5\ub85c\ub4dc \ud6c4 \ud574\ub2f9 \uacbd\ub85c\ub294 ",(0,r.jsx)(n.code,{children:"Kinder.data.logoPath"}),"\uc5d0 \uc800\uc7a5\ub428"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"\ubc30\uacbd-\uc774\ubbf8\uc9c0-\uc5c5\ub85c\ub4dc-platformuploadbg-list",children:["\ubc30\uacbd \uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc (",(0,r.jsx)(n.code,{children:"/platform/upload/bg-list"}),")"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const uploadBg = multer({ ... bucket: 'kindermoumi', key: `bg/...` })\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\ub2e4\uc911 \uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc (\ubc30\uacbd \ud14c\ub9c8\ub85c \ud65c\uc6a9)"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"data.addBgList"})," \ubc30\uc5f4\uc5d0 \ub204\uc801 \uc800\uc7a5"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"\ubc30\uacbd-\uc774\ubbf8\uc9c0-\uc0ad\uc81c-platformbg-data-put",children:["\ubc30\uacbd \uc774\ubbf8\uc9c0 \uc0ad\uc81c (",(0,r.jsx)(n.code,{children:"/platform/bg-data"}),", PUT)"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\uc0ac\uc6a9\uc790\uac00 \ud2b9\uc815 \ubc30\uacbd \uc774\ubbf8\uc9c0\ub97c \uc81c\uac70\ud558\uba74 S3\uc5d0\uc11c\ub3c4 \uc0ad\uc81c \uc694\uccad \uc218\ud589"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"deleteObject"})," \uc0ac\uc6a9\uc73c\ub85c \uc644\uc804 \uc81c\uac70"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const key = req.body.bgSrc.replace(S3_URL_PREFIX, '')\ns3.deleteObject({ Bucket: 'kindermoumi', Key: key })\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"2-\ud648\ud398\uc774\uc9c0-\ub370\uc774\ud130-\uc800\uc7a5-platformuploaddata",children:["2. \ud648\ud398\uc774\uc9c0 \ub370\uc774\ud130 \uc800\uc7a5 (",(0,r.jsx)(n.code,{children:"/platform/upload/data"}),")"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"kinder.data = {\n  ...kinder.data,\n  headerHeight,\n  logoWidth,\n  navDepth1: [...navMainList],\n  navDepth2: {...navSubList},\n  selectBgSrc: newSelectBgSrc,\n  zoneData: {...zoneData},\n  contentsContainer: {...contentsContainer}\n}\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\uc0ac\uc6a9\uc790\uac00 \ucee4\uc2a4\ud130\ub9c8\uc774\uc9d5\ud55c \uac12(\ud5e4\ub354 \ub192\uc774, \ub85c\uace0 \ud06c\uae30, \uba54\ub274, \ubc30\uacbd \ub4f1)\uc744 \ud1b5\uc9f8\ub85c \uc800\uc7a5"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"selectBgSrc"}),"\uc758 \uacbd\uc6b0 ",(0,r.jsx)(n.code,{children:"blob:"})," prefix \uc81c\uac70 \ucc98\ub9ac \ud3ec\ud568"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"3-\ud398\uc774\uc9c0-\uac8c\uc2dc-\uc694\uccad-platformstartpage",children:["3. \ud398\uc774\uc9c0 \uac8c\uc2dc \uc694\uccad (",(0,r.jsx)(n.code,{children:"/platform/startpage"}),")"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Kinder.openPage = true"}),"\ub85c \uc804\ud658 \u2192 \uc0ac\uc6a9\uc790 \uc811\uadfc \ud5c8\uc6a9"]}),"\n",(0,r.jsxs)(n.li,{children:["\uac8c\uc2dc \uc804\uc5d0\ub294 ",(0,r.jsx)(n.code,{children:"/user/openKinder/:kinderCode"})," \uc811\uadfc \uc2dc 404 \ubc18\ud658"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-\uba54\ub274-\ubc0f-\uc2dd\ub2e8\ud45c-\uc124\uc815",children:"4. \uba54\ub274 \ubc0f \uc2dd\ub2e8\ud45c \uc124\uc815"}),"\n",(0,r.jsx)(n.h3,{id:"\uba54\ub274-\uc635\uc158-\ubc0f-\uc81c\uc678-\uc694\uc77c-\uc800\uc7a5",children:"\uba54\ub274 \uc635\uc158 \ubc0f \uc81c\uc678 \uc694\uc77c \uc800\uc7a5"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"menu.deleteYOIL = [...req.body.deleteYOIL] // \uc81c\uc678 \uc694\uc77c\nmenu.sideOptions = [...req.body.sideOptions] // \ubc18\ucc2c \ubaa9\ub85d\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"\uc6d4\ubcc4-\uc2dd\ub2e8\ud45c-\uc800\uc7a5-platformmenutable",children:["\uc6d4\ubcc4 \uc2dd\ub2e8\ud45c \uc800\uc7a5 (",(0,r.jsx)(n.code,{children:"/platform/menu/table"}),")"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const menus = req.body.menus\nconst monthArr = [...new Set(menus.map(obj => obj.date.slice(0, 7)))]\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc6d4\ubcc4\ub85c \ub370\uc774\ud130\ub97c \ubd84\ub9ac\ud558\uc5ec ",(0,r.jsx)(n.code,{children:"MonthMenuTable"}),"\uc5d0 \uc800\uc7a5"]}),"\n",(0,r.jsx)(n.li,{children:"\uae30\uc874 \ub370\uc774\ud130\uac00 \uc788\uc73c\uba74 \uc5c5\ub370\uc774\ud2b8, \uc5c6\uc73c\uba74 \uc0c8\ub85c \uc0dd\uc131"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\uc815\ub9ac",children:"\uc815\ub9ac"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc\ub294 ",(0,r.jsx)(n.code,{children:"multer-s3"}),"\ub97c \ud1b5\ud574 AWS S3\uc5d0 \uc800\uc7a5"]}),"\n",(0,r.jsxs)(n.li,{children:["\ucee4\uc2a4\ud130\ub9c8\uc774\uc9d5 \ub370\uc774\ud130\ub294 MongoDB\uc758 ",(0,r.jsx)(n.code,{children:"Kinder"})," \ubaa8\ub378\uc5d0 \uad6c\uc870\ud654\ud558\uc5ec \uc800\uc7a5"]}),"\n",(0,r.jsxs)(n.li,{children:["\uc2dd\ub2e8\ud45c\ub294 \uc6d4 \ub2e8\uc704\ub85c \ubd84\ub9ac\ud558\uc5ec ",(0,r.jsx)(n.code,{children:"MonthMenuTable"}),"\uc5d0 \uc800\uc7a5"]}),"\n",(0,r.jsx)(n.li,{children:"\uc0ac\uc6a9\uc790\uac00 \uac8c\uc2dc\ub97c \uc120\ud0dd\ud558\uba74 \uc2e4\uc81c \ud648\ud398\uc774\uc9c0\uac00 \uc678\ubd80\uc5d0 \ub178\ucd9c\ub428"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\uc774 \uad6c\uc870\ub97c \ud1b5\ud574 ",(0,r.jsx)(n.strong,{children:"\ube44\uc804\ubb38\uac00\uc778 \uad50\uc0ac\ub3c4 \uc9c1\uad00\uc801\uc73c\ub85c \ud648\ud398\uc774\uc9c0\ub97c \uc81c\uc791\ud558\uace0 \uac8c\uc2dc\ud560 \uc218 \uc788\ub294 \uacbd\ud5d8"}),"\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,l)=>{l.d(n,{R:()=>s,x:()=>o});var d=l(6540);const r={},i=d.createContext(r);function s(e){const n=d.useContext(i);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),d.createElement(i.Provider,{value:n},e.children)}}}]);