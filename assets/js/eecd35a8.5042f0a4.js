"use strict";(self.webpackChunkdev_note=self.webpackChunkdev_note||[]).push([[5519],{4770:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>i,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"img-ttukttakki/update-100","title":"v1.0.0 \uc5c5\ub370\uc774\ud2b8","description":"\uc774\ubbf8\uc9c0 \ubcd1\ud569 \uc800\uc7a5 \uae30\ub2a5 \ucd94\uac00","source":"@site/project/img-ttukttakki/update-100.md","sourceDirName":"img-ttukttakki","slug":"/img-ttukttakki/update-100","permalink":"/dev-note/project/img-ttukttakki/update-100","draft":false,"unlisted":false,"editUrl":"https://github.com/pukkok/dev-note/edit/main/project/img-ttukttakki/update-100.md","tags":[],"version":"current","frontMatter":{"title":"v1.0.0 \uc5c5\ub370\uc774\ud2b8","description":"\uc774\ubbf8\uc9c0 \ubcd1\ud569 \uc800\uc7a5 \uae30\ub2a5 \ucd94\uac00"},"sidebar":"sidebar","previous":{"title":"v0.1.0 \uc5c5\ub370\uc774\ud2b8","permalink":"/dev-note/project/img-ttukttakki/update-010"},"next":{"title":"\uc2dc\uc791\ud558\uae30","permalink":"/dev-note/project/formtok/intro"}}');var o=t(4848),c=t(8453);const r={title:"v1.0.0 \uc5c5\ub370\uc774\ud2b8",description:"\uc774\ubbf8\uc9c0 \ubcd1\ud569 \uc800\uc7a5 \uae30\ub2a5 \ucd94\uac00"},a=void 0,i={},l=[{value:"2025.07.10",id:"20250710",level:3},{value:"\uc8fc\uc694 \uae30\ub2a5 \uc124\uba85",id:"\uc8fc\uc694-\uae30\ub2a5-\uc124\uba85",level:2},{value:"\ubc30\uacbd + \uc624\ubc84\ub808\uc774 \uc774\ubbf8\uc9c0 \ubcd1\ud569",id:"\ubc30\uacbd--\uc624\ubc84\ub808\uc774-\uc774\ubbf8\uc9c0-\ubcd1\ud569",level:3},{value:"CropBox \ub9c8\uc2a4\ud0b9",id:"cropbox-\ub9c8\uc2a4\ud0b9",level:3},{value:"\uae30\uc220\uc801 \uac1c\uc120 \uc0ac\ud56d",id:"\uae30\uc220\uc801-\uac1c\uc120-\uc0ac\ud56d",level:2},{value:"\uc548\uc815\uc801\uc778 fabric.js \ubc84\uc804\uc73c\ub85c \ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc",id:"\uc548\uc815\uc801\uc778-fabricjs-\ubc84\uc804\uc73c\ub85c-\ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc",level:3},{value:"\uc0c1\ud0dc \uad00\ub9ac: zustand \ub3c4\uc785",id:"\uc0c1\ud0dc-\uad00\ub9ac-zustand-\ub3c4\uc785",level:3},{value:"\uc8fc\uc694 \ucf54\ub4dc \uc124\uba85",id:"\uc8fc\uc694-\ucf54\ub4dc-\uc124\uba85",level:2},{value:"<span><strong>\ubc30\uacbd \ub370\uc774\ud130 \uad00\ub9ac</strong></span>",id:"\ubc30\uacbd-\ub370\uc774\ud130-\uad00\ub9ac",level:3},{value:"<span><strong>CropBox \ub9c8\uc2a4\ud0b9</strong></span>",id:"cropbox-\ub9c8\uc2a4\ud0b9-1",level:3},{value:"<span><strong>\uc624\ubc84\ub808\uc774 \uc774\ubbf8\uc9c0 \uad00\ub9ac</strong></span>",id:"\uc624\ubc84\ub808\uc774-\uc774\ubbf8\uc9c0-\uad00\ub9ac",level:3},{value:"<span><strong>\ud06c\ub86d\ubc15\uc2a4 \uc0c1\uc2dc \uc5c5\ub370\uc774\ud2b8</strong></span>",id:"\ud06c\ub86d\ubc15\uc2a4-\uc0c1\uc2dc-\uc5c5\ub370\uc774\ud2b8",level:3}];function d(n){const e={blockquote:"blockquote",br:"br",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h3,{id:"20250710",children:"2025.07.10"}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)("span",{style:{color:"#e67e22"},children:(0,o.jsx)("strong",{children:"\ubc30\uacbd \uc774\ubbf8\uc9c0"})}),"\ub97c \ubc30\uce58\ud558\uace0\n\uadf8 \uc704\uc5d0 ",(0,o.jsx)("span",{style:{color:"#e67e22"},children:(0,o.jsx)("strong",{children:"\ub2e4\ub978 \uc774\ubbf8\uc9c0"})}),"\ub97c \ubc30\uce58\ud558\uc5ec\n",(0,o.jsx)("span",{style:{color:"#e67e22"},children:(0,o.jsx)("strong",{children:"\uc774\ubbf8\uc9c0\ub97c \ubcd1\ud569"})})," \uc2dc\ud0ac \uc218 \uc788\ub294 \uae30\ub2a5\uc744 \ub3c4\uc785\ud558\uc600\uc2b5\ub2c8\ub2e4."]}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h2,{id:"\uc8fc\uc694-\uae30\ub2a5-\uc124\uba85",children:"\uc8fc\uc694 \uae30\ub2a5 \uc124\uba85"}),"\n",(0,o.jsx)(e.h3,{id:"\ubc30\uacbd--\uc624\ubc84\ub808\uc774-\uc774\ubbf8\uc9c0-\ubcd1\ud569",children:"\ubc30\uacbd + \uc624\ubc84\ub808\uc774 \uc774\ubbf8\uc9c0 \ubcd1\ud569"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\ubc30\uacbd \uc774\ubbf8\uc9c0 \uc704\uc5d0 \uc5ec\ub7ec \uc774\ubbf8\uc9c0\ub97c \ubc30\uce58\ud558\uace0, \uc774\ub3d9/\ud655\ub300/\ud68c\uc804 \ub4f1\uc758 \uc870\uc791 \ud6c4 \ubcd1\ud569 \uc800\uc7a5 \uac00\ub2a5."}),"\n",(0,o.jsxs)(e.li,{children:["\uac01 \uc774\ubbf8\uc9c0 \uac1d\uccb4\uc758 \uc18d\uc131(",(0,o.jsx)(e.code,{children:"left"}),", ",(0,o.jsx)(e.code,{children:"top"}),", ",(0,o.jsx)(e.code,{children:"scale"}),", ",(0,o.jsx)(e.code,{children:"angle"}),", ",(0,o.jsx)(e.code,{children:"skewX/Y"}),")\uc744 \uc720\uc9c0\ud558\uba70 \uc800\uc7a5."]}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"cropbox-\ub9c8\uc2a4\ud0b9",children:"CropBox \ub9c8\uc2a4\ud0b9"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\ubcd1\ud569 \uc2dc \uc790\ub974\uae30(Crop)\ub97c \uc704\ud55c ",(0,o.jsx)(e.code,{children:"CropBox"})," UI \uc81c\uacf5."]}),"\n",(0,o.jsx)(e.li,{children:"\uc0ac\uc6a9\uc790\uac00 \uc120\ud0dd\ud55c \uc601\uc5ed \uc678 \ubd80\ubd84\uc740 \ubc18\ud22c\uba85 \ub9c8\uc2a4\ud0b9 \ucc98\ub9ac\ub428."}),"\n"]}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h2,{id:"\uae30\uc220\uc801-\uac1c\uc120-\uc0ac\ud56d",children:"\uae30\uc220\uc801 \uac1c\uc120 \uc0ac\ud56d"}),"\n",(0,o.jsx)(e.h3,{id:"\uc548\uc815\uc801\uc778-fabricjs-\ubc84\uc804\uc73c\ub85c-\ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc",children:"\uc548\uc815\uc801\uc778 fabric.js \ubc84\uc804\uc73c\ub85c \ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:["\ucd08\uae30\uc5d0\ub294 \ucd5c\uc2e0 \ubc84\uc804\uc778 ",(0,o.jsx)(e.code,{children:"fabric@6.x"}),"\ub97c \uc0ac\uc6a9\ud588\uc9c0\ub9cc \ub2e4\uc74c\uacfc \uac19\uc740 \ubb38\uc81c\uac00 \ubc1c\uc0dd:"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"preserveObjectStacking"})," \uc635\uc158 \ubb34\uc2dc\ub428"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"bringToFront"}),", ",(0,o.jsx)(e.code,{children:"sendToBack"}),"\uc774 \ubd88\uc548\uc815\ud558\uac8c \uc791\ub3d9"]}),"\n",(0,o.jsx)(e.li,{children:"\uc77c\ubd80 \uac1d\uccb4\uac00 \uc608\uae30\uce58 \uc54a\uac8c \ucee8\ud2b8\ub864\ub7ec\ub97c \uc783\uac70\ub098 \uc774\ub3d9 \ubd88\uac00 \uc0c1\ud0dc \ubc1c\uc0dd"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"\ud574\uacb0:"})," \uc548\uc815\uc131\uc774 \uac80\uc99d\ub41c ",(0,o.jsx)(e.code,{children:"fabric@4.6.0"})," \ubc84\uc804\uc73c\ub85c \ub2e4\uc6b4\uadf8\ub808\uc774\ub4dc\ud558\uc5ec \ub80c\ub354\ub9c1 \uc21c\uc11c \ubc0f \uac1d\uccb4 \uc81c\uc5b4 \ubb38\uc81c \ud574\uacb0",(0,o.jsx)(e.br,{}),"\n","\u2192 \uc774\ud6c4 \ubaa8\ub4e0 \uac1d\uccb4\ub294 ",(0,o.jsx)(e.code,{children:"customType"}),"\uc744 \uae30\uc900\uc73c\ub85c \uad00\ub9ac\ud558\uba70 ",(0,o.jsx)(e.code,{children:".bringToFront()"})," \uba85\uc2dc\uc801\uc73c\ub85c \ud638\ucd9c"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"\uc0c1\ud0dc-\uad00\ub9ac-zustand-\ub3c4\uc785",children:"\uc0c1\ud0dc \uad00\ub9ac: zustand \ub3c4\uc785"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\uae30\uc874\uc5d0\ub294 React ",(0,o.jsx)(e.code,{children:"useState"})," \uae30\ubc18\uc73c\ub85c \ubaa8\ub4e0 \uc0c1\ud0dc\ub97c \uc804\ub2ec\ud588\uc9c0\ub9cc,\n\uc774\ubbf8\uc9c0 \ubaa9\ub85d, \ud604\uc7ac \uc791\uc5c5 \uc911\uc778 \uc774\ubbf8\uc9c0, Crop \uc601\uc5ed \uc815\ubcf4 \ub4f1 \ubcf5\uc7a1\ud55c \uc0c1\ud0dc \uc804\ub2ec\uc774 \uc5b4\ub824\uc6cc\uc84c\uc74c"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"\ud574\uacb0:"})," \uc0c1\ud0dc \uad00\ub9ac\ub97c \uc704\ud55c ",(0,o.jsx)(e.code,{children:"zustand"})," \ub3c4\uc785","\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"useMergeCanvasStore"})," : \ubcd1\ud569/\ud06c\ub86d \uad00\ub828 \uc0c1\ud0dc \uc804\uc6a9"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"useCommonStore"})," : \uacf5\ud1b5 \uc774\ubbf8\uc9c0 \ubaa9\ub85d \ubc0f \ud604\uc7ac \uc778\ub371\uc2a4 \ub4f1 \uad00\ub9ac"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsxs)(e.p,{children:["\uc804\uc5ed \uc0c1\ud0dc\uac00 \ud544\uc694\ud558\uc9c0 \uc54a\uc558\ub358 \ucd08\uae30 \uad6c\uc870\uc5d0\uc120 ",(0,o.jsx)(e.code,{children:"useState"}),"\ub85c \ucda9\ubd84\ud588\uc9c0\ub9cc,",(0,o.jsx)(e.br,{}),"\n",(0,o.jsx)(e.strong,{children:"Canvas \uac1d\uccb4\uc640 \uad00\ub828\ub41c \uc678\ubd80 \ucc38\uc870\uac12\uc744 \uc720\uc9c0/\ub3d9\uae30\ud654"}),"\ud558\ub824\uba74 store \uae30\ubc18 \uc811\uadfc\uc774 \uc548\uc815\uc801\uc774\uc5c8\uc74c."]}),"\n"]}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h2,{id:"\uc8fc\uc694-\ucf54\ub4dc-\uc124\uba85",children:"\uc8fc\uc694 \ucf54\ub4dc \uc124\uba85"}),"\n",(0,o.jsx)(e.h3,{id:"\ubc30\uacbd-\ub370\uc774\ud130-\uad00\ub9ac",children:(0,o.jsx)("span",{style:{color:"#e67e22"},children:(0,o.jsx)("strong",{children:"\ubc30\uacbd \ub370\uc774\ud130 \uad00\ub9ac"})})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\uac01 \uc774\ubbf8\uc9c0 \uac1d\uccb4\uc758 \uc18d\uc131 (",(0,o.jsx)(e.code,{children:"left"}),", ",(0,o.jsx)(e.code,{children:"top"}),", ",(0,o.jsx)(e.code,{children:"scale"}),", ",(0,o.jsx)(e.code,{children:"angle"}),", ",(0,o.jsx)(e.code,{children:"skewX/Y"}),") \uc744 \uc720\uc9c0\ud558\uba70 \uc800\uc7a5\ub428."]}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-js",children:"useEffect(() => {\n  const canvas = fabricCanvasRef.current\n  if (!canvas) return\n\n  const handleModified = (e) => {\n    const obj = e.target\n    if (obj?.get('customType') !== 'background') return\n\n    setBackgroundImageInfo({\n      width: obj.width * obj.scaleX,\n      height: obj.height * obj.scaleY,\n      left: obj.left,\n      top: obj.top,\n      rotation: obj.angle || 0,\n      skewX: obj.skewX || 0,\n      skewY: obj.skewY || 0,\n    })\n  }\n\n  canvas.on('object:modified', handleModified)\n  canvas.on('object:moving', handleModified)\n  canvas.on('object:scaling', handleModified)\n  canvas.on('object:rotating', handleModified)\n\n  return () => {\n    canvas.off('object:modified', handleModified)\n    canvas.off('object:moving', handleModified)\n    canvas.off('object:scaling', handleModified)\n    canvas.off('object:rotating', handleModified)\n  }\n}, [])\n"})}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h3,{id:"cropbox-\ub9c8\uc2a4\ud0b9-1",children:(0,o.jsx)("span",{style:{color:"#e67e22"},children:(0,o.jsx)("strong",{children:"CropBox \ub9c8\uc2a4\ud0b9"})})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\ubcd1\ud569 \uc2dc \uc790\ub974\uae30(Crop)\ub97c \uc704\ud55c ",(0,o.jsx)(e.strong,{children:"CropBox"})," UI \uc81c\uacf5."]}),"\n",(0,o.jsxs)(e.li,{children:["\uc0ac\uc6a9\uc790\uac00 \uc120\ud0dd\ud55c \uc601\uc5ed \uc678 \ubd80\ubd84\uc740 ",(0,o.jsx)(e.strong,{children:"\ubc18\ud22c\uba85 \ub9c8\uc2a4\ud0b9"}),"\uc73c\ub85c \ucc98\ub9ac."]}),"\n",(0,o.jsx)(e.li,{children:"\ub9c8\uc2a4\ud06c\ub294 \ucd1d 8\uac1c\uc758 \uc0ac\uac01\ud615\uc73c\ub85c \uad6c\uc131\ub418\uba70, cropBox\uc758 \uc704\uce58/\ud06c\uae30\uc5d0 \ub530\ub77c \uc2e4\uc2dc\uac04\uc73c\ub85c \uc704\uce58 \uc870\uc815\ub428."}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"useCropBox"})," \ud6c5\uc5d0\uc11c cropBox\uc640 mask\ub97c \uc0dd\uc131 \ubc0f \uac31\uc2e0."]}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-js",children:"const updateMask = () => {\n  const canvas = fabricCanvasRef.current\n  const cropBox = cropCanvasRef.current\n  const masks = maskRefs.current\n  if (!canvas || !cropBox) return\n\n  const { left, top, width, height, scaleX, scaleY, originX, originY } = cropBox\n  \n  const actualWidth = width * scaleX\n  const actualHeight = height * scaleY\n\n  const boxLeft = originX === 'center' ? left - actualWidth / 2 : left\n  const boxTop = originY === 'center' ? top - actualHeight / 2 : top\n  const boxRight = boxLeft + actualWidth\n  const boxBottom = boxTop + actualHeight\n\n  const canvasWidth = canvas.getWidth()\n  const canvasHeight = canvas.getHeight()\n\n  // \uc88c\uc0c1\ub2e8\n  masks.topLeft.set({\n    left: 0, top: 0, width: boxLeft, height: boxTop,\n  })\n\n  // \uc0c1\ub2e8 \uc911\uc559\n  masks.top.set({\n    left: boxLeft, top: 0, width: actualWidth, height: boxTop,\n  })\n\n  // \uc6b0\uc0c1\ub2e8\n  masks.topRight.set({\n    left: boxRight, top: 0, width: canvasWidth - boxRight, height: boxTop,\n  })\n\n  // \uc88c\n  masks.left.set({\n    left: 0, top: boxTop, width: boxLeft, height: actualHeight,\n  })\n\n  // \uc6b0\n  masks.right.set({\n    left: boxRight, top: boxTop, width: canvasWidth - boxRight, height: actualHeight,\n  })\n\n  // \uc88c\ud558\ub2e8\n  masks.bottomLeft.set({\n    left: 0, top: boxBottom, width: boxLeft, height: canvasHeight - boxBottom,\n  })\n\n  // \ud558\ub2e8 \uc911\uc559\n  masks.bottom.set({\n    left: boxLeft, top: boxBottom, width: actualWidth, height: canvasHeight - boxBottom,\n  })\n\n  // \uc6b0\ud558\ub2e8\n  masks.bottomRight.set({\n    left: boxRight, top: boxBottom, width: canvasWidth - boxRight, height: canvasHeight - boxBottom,\n  })\n\n  bringCropBoxToFront()\n  setCropBoxInfo({\n    left, top,\n    width: actualWidth, height: actualHeight\n  })\n  canvas.requestRenderAll()\n}\n"})}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h3,{id:"\uc624\ubc84\ub808\uc774-\uc774\ubbf8\uc9c0-\uad00\ub9ac",children:(0,o.jsx)("span",{style:{color:"#e67e22"},children:(0,o.jsx)("strong",{children:"\uc624\ubc84\ub808\uc774 \uc774\ubbf8\uc9c0 \uad00\ub9ac"})})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\uc624\ubc84\ub808\uc774 \uc774\ubbf8\uc9c0\ub294 \ubc30\uc5f4\uc548\uc5d0\uc11c \uc5ec\ub7ec \uc774\ubbf8\uc9c0\ub97c \uad00\ub9ac\ud558\uc9c0\ub9cc \ud558\ub098\uc529 \ubd88\ub7ec\uc11c \uc0ac\uc6a9\ud568."}),"\n",(0,o.jsxs)(e.li,{children:["\uc774\ubbf8\uc9c0\ub294 \ubd88\ub7ec\uc62c \ub54c \uae30\uc874 \uc815\ubcf4\ub97c \ub2e4\uc2dc \uc0ac\uc6a9\ud560 \uc218 \uc788\ub3c4\ub85d fabric\uc758 ",(0,o.jsx)(e.strong,{children:"clone"})," \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud568."]}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-js",children:"import { useEffect } from 'react'\nimport { fabric } from 'fabric'\nimport { useCommonStore } from '../../../stores/useCommonStore'\n\nexport const useOverlayImage = (fabricCanvasRef, overlayImageRef, onLoaded) => {\n  const images = useCommonStore(s => s.images)\n  const getCurrentIndex = useCommonStore(s => s.getCurrentIndex)\n\n  const currentIndex = getCurrentIndex()\n  const currentImage = images[currentIndex] || null\n\n  useEffect(() => {\n    const canvas = fabricCanvasRef.current\n    if (!canvas) return\n\n    const handleModified = (e) => {\n      const obj = e.target\n      if (!obj || obj.customType !== 'overlay' || !currentImage?.id) return\n\n      const ref = overlayImageRef.current[currentImage.id]\n      if (!ref) return\n\n      ref.left = obj.left\n      ref.top = obj.top\n      ref.width = obj.width * obj.scaleX\n      ref.height = obj.height * obj.scaleY\n      ref.angle = obj.angle || 0\n      ref.skewX = obj.skewX || 0\n      ref.skewY = obj.skewY || 0\n    }\n\n    canvas.on('object:modified', handleModified)\n    canvas.on('object:moving', handleModified)\n    canvas.on('object:scaling', handleModified)\n    canvas.on('object:rotating', handleModified)\n\n    return () => {\n      canvas.off('object:modified', handleModified)\n      canvas.off('object:moving', handleModified)\n      canvas.off('object:scaling', handleModified)\n      canvas.off('object:rotating', handleModified)\n    }\n  }, [currentImage?.id])\n\n  useEffect(() => {\n    const canvas = fabricCanvasRef.current\n    if (!canvas || !currentImage?.url) return\n\n    // INFO: \uae30\uc874 overlay \uc81c\uac70\n    // TODO: \ud55c\ubc88\uc5d0 \ud55c\uc7a5\uc758 image\ub9cc \ubd88\ub7ec\uc640\uc11c \uc0ac\uc6a9\ud55c\ub2e4.\n    canvas.getObjects().forEach(obj => {\n      if (obj.customType === 'overlay') {\n        canvas.remove(obj)\n      }\n    })\n\n    const canvasWidth = canvas.getWidth()\n    const canvasHeight = canvas.getHeight()\n    const saved = overlayImageRef.current[currentImage.id]\n\n    // TODO: \ucd08\uae30 \uc774\ubbf8\uc9c0\ub97c \ubd88\ub7ec\uc628\ub2e4.\n    const initializeOverlayImage = (img) => {\n      const maxHeight = (canvasHeight * 2) / 3\n      const scale = Math.min(1, maxHeight / img.height)\n\n      const scaledWidth = img.width * scale\n      const scaledHeight = img.height * scale\n      const left = canvasWidth / 2 - scaledWidth / 2\n      const top = canvasHeight / 2 - scaledHeight / 2\n\n      img.set({\n        left,\n        top,\n        width: img.width,\n        height: img.height,\n        scaleX: scale,\n        scaleY: scale,\n        angle: 0,\n        skewX: 0,\n        skewY: 0,\n        selectable: true,\n        evented: true,\n        hasControls: true,\n        cornerStyle: 'circle',\n        customType: 'overlay',\n      })\n\n      overlayImageRef.current[currentImage.id] = {\n        left,\n        top,\n        width: img.width * scale,\n        height: img.height * scale,\n        angle: 0,\n        skewX: 0,\n        skewY: 0,\n        img,\n      }\n\n      canvas.add(img)\n      canvas.setActiveObject(img)\n\n      const bgObj = canvas.getObjects().find(obj => obj.customType === 'background')\n      if (bgObj) canvas.sendToBack(bgObj)\n\n      if (typeof onLoaded === 'function') onLoaded()\n    }\n\n    // INFO: \ud074\ub860\uc774\uae30 \ub54c\ubb38\uc5d0 scale\uac12\uc744 \ub418\ub3cc\ub824\uc11c \ub2e4\uc2dc \uc0ac\uc6a9\ud55c\ub2e4.\n    // TODO : \ubcf5\uc0ac\ud558\uc5ec \ub2e4\uc2dc \uac00\uc838\uc628\ub2e4. \uacc4\uc18d \uac1d\uccb4\ub97c \ub9cc\ub4dc\ub294 \ud589\uc704 \uc81c\uac70\n    const restoreOverlayImage = (img) => {\n      const { left, top, width, height, angle, skewX, skewY } = saved\n      const scaleX = width / img.width\n      const scaleY = height / img.height\n\n      img.set({\n        left,\n        top,\n        scaleX,\n        scaleY,\n        angle,\n        skewX,\n        skewY,\n        cornerStyle: 'circle',\n        selectable: true,\n        evented: true,\n        hasControls: true,\n        customType: 'overlay',\n      })\n\n      saved.img = img\n\n      canvas.add(img)\n      canvas.setActiveObject(img)\n\n      const bgObj = canvas.getObjects().find(obj => obj.customType === 'background')\n      if (bgObj) canvas.sendToBack(bgObj)\n\n      if (typeof onLoaded === 'function') onLoaded()\n    }\n\n    const loadImage = async () => {\n      try {\n        if (saved?.img) {\n          saved.img.clone(clone => restoreOverlayImage(clone))\n        } else {\n          // INFO: \uc0c8\ub85c\uc6b4 \uc774\ubbf8\uc9c0 \uac1d\uccb4\ub97c \ubd88\ub7ec\uc628\ub2e4.\n          fabric.Image.fromURL(currentImage.url, img => {\n            if (img) initializeOverlayImage(img)\n            else console.error('Image load error')\n          })\n        }\n      } catch (err) {\n        console.error('\uc791\uc5c5 \uc774\ubbf8\uc9c0 \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328:', err)\n      }\n    }\n\n    loadImage()\n  }, [currentImage])\n}\n\n"})}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsx)(e.h3,{id:"\ud06c\ub86d\ubc15\uc2a4-\uc0c1\uc2dc-\uc5c5\ub370\uc774\ud2b8",children:(0,o.jsx)("span",{style:{color:"#e67e22"},children:(0,o.jsx)("strong",{children:"\ud06c\ub86d\ubc15\uc2a4 \uc0c1\uc2dc \uc5c5\ub370\uc774\ud2b8"})})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\ud06c\ub86d\ubc15\uc2a4\uc758 ",(0,o.jsx)(e.code,{children:"bringToFront"})," \ud568\uc218\ub97c return \ud558\uc5ec \uc678\ubd80\uc5d0\uc11c\ub3c4 \uc0ac\uc6a9\ud560 \uc218 \uc788\ub3c4\ub85d \uad6c\ud604."]}),"\n",(0,o.jsxs)(e.li,{children:["\uc0ac\uc6a9\ucc98\uc5d0\uc120 onLoaded\ub85c \uc804\ub2ec\ubc1b\uc544 ",(0,o.jsx)(e.strong,{children:"callBack"})," \ud615\ud0dc\ub85c \uc791\uc5c5\uc774 \ub05d\ub09c \ud6c4\uc5d0 \ub3d9\uc791\ud558\ub3c4\ub85d \uad6c\ud604."]}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-js",children:"const bringCropBoxToFront = () => {\n  const canvas = fabricCanvasRef.current\n  const cropBox = cropCanvasRef.current\n  if (!canvas || !cropBox) return\n\n  Object.values(maskRefs.current).forEach(mask => {\n    canvas.bringToFront(mask)\n  })\n  canvas.bringToFront(cropBox)\n}\n\n// \uc0ac\uc6a9\ucc98 \uc77c\ubd80\nconst MergeCanvasEditor = ({ fabricCanvasRef, overlayImageRef, cropCanvasRef }) => {\n  const canvasRef = useRef(null)\n\n  useSetupCanvas(canvasRef, fabricCanvasRef)\n  const { bringCropBoxToFront } = useCropBox(fabricCanvasRef, cropCanvasRef)\n  useBackgroundImage(fabricCanvasRef, bringCropBoxToFront)\n  useOverlayImage(fabricCanvasRef, overlayImageRef, bringCropBoxToFront)\n\n  return <canvas ref={canvasRef} />\n}\n\nexport default MergeCanvasEditor\n\n"})}),"\n",(0,o.jsxs)(e.p,{children:["\uc774\ub7ec\ud55c \ud6c5 \uad6c\uc870\ub97c \ud1b5\ud574 ",(0,o.jsx)("span",{style:{color:"#e67e22"},children:(0,o.jsx)("strong",{children:"\ubc30\uacbd \uc774\ubbf8\uc9c0, \uc624\ubc84\ub808\uc774 \uc774\ubbf8\uc9c0, \ud06c\ub86d \ubc15\uc2a4"})})," \uac04\uc758 \uc0c1\ud0dc \ubc0f \uc0c1\ud638\uc791\uc6a9\uc744 \uc720\uc5f0\ud558\uac8c \uad6c\uc131\ud558\uc600\uc73c\uba70, ",(0,o.jsx)("br",{}),"\n",(0,o.jsx)("span",{style:{color:"#e67e22"},children:(0,o.jsx)("strong",{children:"Zustand \uae30\ubc18 \uc0c1\ud0dc\uad00\ub9ac"})}),"\uc640 \ud568\uaed8 \uc548\uc815\uc801\uc778 \ub80c\ub354\ub9c1 \ub3d9\uae30\ud654\ub97c \uad6c\ud604\ud588\uc2b5\ub2c8\ub2e4."]})]})}function h(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(d,{...n})}):d(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>r,x:()=>a});var s=t(6540);const o={},c=s.createContext(o);function r(n){const e=s.useContext(c);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:r(n.components),s.createElement(c.Provider,{value:e},n.children)}}}]);